/*
 Copyright @ 2018 Alessandro Zifiglio. All rights reserved. https://www.calendarista.com
*/
(function(e){var b=e.Calendarista||{};b.createDelegate=function(a,c){return function(){return c.apply(a,arguments)}};b.createCallback=function(a,c,d){return function(){var f=arguments.length;if(f>0){for(var h=[],g=0;g<f;g++)h[g]=arguments[g];h[f]=d;return a.apply(c||this,h)}return a.call(c||this,d)}};e.Calendarista||(e.Calendarista=b)})(window);
(function(e){var b=e.Calendarista||function(){};b.Cookie=function(){};b.Cookie.create=function(a,c,d){var f;if(d){f=new Date;f.setTime(f.getTime()+d*24*60*60*1E3);d="; expires="+f.toGMTString()}else d="";document.cookie=a+"="+c+d+"; path=/"};b.Cookie.read=function(a){a=a+"=";var c=document.cookie.split(";"),d,f;for(f=0;f<c.length;f++){for(d=c[f];d.charAt(0)==" ";)d=d.substring(1,d.length);if(d.indexOf(a)==0)return d.substring(a.length,d.length)}return null};b.Cookie.erase=function(a){b.Cookie.create(a,
"",-1)};b.Cookie.destroy=function(){};e.Calendarista||(e.Calendarista=b)})(window);
(function(e,b){b.ajax=function(a){this.init(a);this.destroyDelegate=b.createDelegate(this,this.destroy);e(window).unload(this.destroyDelegate)};b.ajax.prototype.init=function(a){this.id=a.id;this.ajaxUrl=a.ajaxUrl};b.ajax.prototype.request=function(a,c,d){(function(f,h,g,i){i.showSpinner();e.post(i.ajaxUrl,g,function(j){h.call(f,j);i.hideSpinner()})})(a,c,d,this)};b.ajax.prototype.showSpinner=function(){e("#spinner_"+this.id).removeClass("calendarista-invisible")};b.ajax.prototype.hideSpinner=function(){e("#spinner_"+
this.id).addClass("calendarista-invisible")};b.ajax.prototype.destroy=function(){if(this.destroyDelegate){e(window).off("unload",this.destroyDelegate);delete this.destroyDelegate}}})(window.jQuery,window.Calendarista);
(function(e,b){b.wizard=function(a){this.init(a);this.destroyDelegate=b.createDelegate(this,this.destroy);e(window).unload(this.destroyDelegate)};b.wizard.isValid=function(a){var c=true;a.find(".calendarista_parsley_validated, .woald_parsley_validated").each(function(){var d=e(this);if(!d.is(":visible")&&d.attr("type")!=="hidden"||d.is(":disabled")||d.attr("data-parsley-excluded"))return true;d.parsley().reset();d=d.parsley?d.parsley().validate():true;if(d!==null&&typeof d==="object"&&d.length>0)c=
false});return c};b.wizard.prototype.init=function(a){this.id=a.id;this.action=a.action;this.ajaxUrl=a.ajaxUrl;this.requestUrl=a.requestUrl;this.ajax=new b.ajax({ajaxUrl:this.ajaxUrl,id:this.id});this.prevIndex=a.prevIndex;this.nextIndex=a.nextIndex;this.stepCounter=a.stepCounter;this.appointment=a.appointment;this.selectedStepName=a.selectedStepName;this.selectedStepIndex=a.selectedStepIndex;this.invoiceId=a.invoiceId;this.steps=a.steps;this.$footer=this.$root=e("#"+this.id);if([0,1].indexOf(this.appointment)!==
-1)this.$footer=e(".ui-dialog-buttonset."+this.id);this.initAjaxElements()};b.wizard.prototype.initAjaxElements=function(){var a,c,d,f=this;this.$form=this.$root.find("form");this.$prevButton=this.$footer.find('button[name="prev"]');this.$nextButton=this.$footer.find('button[name="next"]');this.$bookNowButton=this.$footer.find('button[name="booknow"]');this.$breadcrumbLinks=this.$root.find(".calendarista-breadcrumb a");this.prevButtonClickDelegate=b.createDelegate(this,this.prevButtonClick);this.$prevButton.on("click",
this.prevButtonClickDelegate);this.nextButtonClickDelegate=b.createDelegate(this,this.nextButtonClick);this.$nextButton.on("click",this.nextButtonClickDelegate);this.$breadcrumbLinks.on("click",function(h){var g=e(h.currentTarget);h.preventDefault();g.attr("disabled")||f.request(parseInt(g.attr("data-calendarista-index"),10));return false});this.appointment===0&&this.createAppointment();for(a=0;a<this.$breadcrumbLinks.length;a++){c=e(this.$breadcrumbLinks[a]);d=parseInt(c.attr("data-calendarista-index"),
10);if(d===this.selectedStepIndex||this.appointment!==1&&d>this.selectedStepIndex){c.attr("disabled",true);c.addClass("calendarista-breadcrumb-disabled")}}};b.wizard.prototype.createAppointment=function(){this.$prevButton.attr("disabled",true).addClass("ui-state-disabled");this.$nextButton.attr("disabled",true).addClass("ui-state-disabled");this.$bookNowButton.attr("disabled",true).addClass("ui-state-disabled");this.$prevButton.val(this.prevIndex);this.$nextButton.val(this.nextIndex);this.prevIndex>
0&&this.$prevButton.removeAttr("disabled").removeClass("ui-state-disabled");if(this.nextIndex<=this.stepCounter)this.$nextButton.removeAttr("disabled").removeClass("ui-state-disabled");else this.nextIndex===this.stepCounter+1&&this.$bookNowButton.removeAttr("disabled").removeClass("ui-state-disabled")};b.wizard.prototype.navButtonClick=function(a){a.preventDefault();this.request(parseInt(e(a.target).val(),10))};b.wizard.prototype.prevButtonClick=function(a){a.preventDefault();this.request(parseInt(this.$prevButton.val(),
10))};b.wizard.prototype.nextButtonClick=function(a){a.preventDefault();b.wizard.isValid(this.$root)?this.request(parseInt(this.$nextButton.val(),10)):this.scrollTop()};b.wizard.prototype.request=function(a){var c=this.$form.serializeArray();c.push({name:"selectedStep",value:a});c.push({name:"action",value:this.action});this.ajax.request(this,this.response,e.param(c))};b.wizard.prototype.response=function(a){this.destroy();this.$root=this.$root.replaceWith(a);this.scrollTop()};b.wizard.prototype.scrollTop=
function(){this.$root.offset();this.$root.length>0&&this.$root[0].scrollIntoView()};b.wizard.prototype.destroy=function(){this.$prevButton&&this.$prevButton.off();this.$nextButton&&this.$nextButton.off();this.$breadcrumbLinks&&this.$breadcrumbLinks.off();delete this.$bookNowButton;delete this.bookNowButtonClickDelegate;delete this.prevButtonClickDelegate;delete this.$prevButton;delete this.nextButtonClickDelegate;delete this.$nextButton;delete this.$breadcrumbLinks;delete this.$footer;if(this.destroyDelegate){e(window).off("unload",
this.destroyDelegate);delete this.destroyDelegate}}})(window.jQuery,window.Calendarista);
(function(e,b){b.calendar=function(a){this.init(a);this.unloadDelegate=b.createDelegate(this,this.unload);e(window).unload(this.unloadDelegate)};b.calendar.prototype.init=function(a){this.id=a.id;this.$root=e("#"+this.id);this.actionWizard="calendarista_wizard";this.actionGetAllAvailabilities="calendarista_get_all_availabilities";this.actionMonthChange="calendarista_calendar_month_change";this.actionStartDaySelected="calendarista_calendar_start_day_selected";this.actionEndDaySelected="calendarista_calendar_end_day_selected";
this.actionSeats="calendarista_seats";this.actionCostSummary="calendarista_cost_summary";this.timeslotCalendarModes=[1];this.calendarMode=a.calendarMode;this.ajaxUrl=a.ajaxUrl;this.projectId=a.projectId;this.dateFormat=a.dateFormat?a.dateFormat:"DD, d MM, yy";this.thumbnails=a.thumbnails;this.appointment=a.appointment;this.currentMonthExclusions=[];this.ajax=new b.ajax({ajaxUrl:this.ajaxUrl,id:this.id});this.$form=this.$root.find("form");this.$postbackStep=this.$root.find('input[name="postbackStep"]');
this.$viewState=this.$root.find('input[name="__viewstate"]');this.$startDate=this.$root.find(".calendarista-start-date");this.$startDateField=this.$root.find('input[name="availableDate"]');this.$timeslotsError=this.$root.find(".calendarista-timeslots-error");this.$startTimeslotPlaceHolder=this.$root.find(".calendarista-start-timeslot-placeholder");this.$calendarLegend=this.$root.find(".calendarista-calendar-legend"+this.projectId);this.$costSummaryPlaceholder=this.$root.find(".calendarista-cost-summary-placeholder");
this.$projectList=this.$root.find('input[name="projectList"]');this.$projectsListbox=this.$root.find('select[name="projects"]');this.$projectId=this.$root.find('input[name="projectId"]');this.$projectsListbox.on("change",b.createDelegate(this,this.projectsChanged));this.$availabilityField=this.$root.find('input[name="availabilityId"]');this.availabilityId=parseInt(this.$availabilityField.val(),10);this.$availabilityListbox=this.$root.find('select[name="availability"]');this.$availabilityListbox.on("change",
b.createDelegate(this,this.availabilityChanged));this.$wizardSectionBlock=this.$root.find(".calendarista-wizard-section-block");this.$wizardSectionThumbnail=this.$root.find(".calendarista-wizard-section-block-thumb");this.$previewUrlField=this.$root.find('input[name="previewUrl"]');this.createCalendars();this.applyAvailabilityThumbnail(this.availabilityId);this.timezone=null};b.calendar.prototype.requestCurrentMonthCalendar=function(){var a=new Date,c=a.getMonth()+1;this.calendarRequestByMonth(a.getFullYear(),
c);this.datepickerReset()};b.calendar.prototype.applyAvailabilityThumbnail=function(a){var c,d,f;if(this.thumbnails.length){if(a)for(c=0;c<this.thumbnails.length;c++){d=this.thumbnails[c];if(d.id===a){f=d.url;break}}this.$wizardSectionBlock.addClass("calendarista-wizard-section-no-thumbnail");this.$wizardSectionBlock.removeClass("calendarista-wizard-section-thumbnail");this.$wizardSectionThumbnail.css("display","none");this.$previewUrlField.val(f);if(f){this.$wizardSectionBlock.addClass("calendarista-wizard-section-thumbnail");
this.$wizardSectionBlock.removeClass("calendarista-wizard-section-no-thumbnail");this.$wizardSectionThumbnail.css({display:"block","background-image":'url("'+f+'")'})}}};b.calendar.prototype.projectsChanged=function(){var a=[{name:"projectId",value:parseInt(this.$projectsListbox.val(),10)},{name:"projectList",value:this.$projectList.val()},{name:"action",value:this.actionWizard}];this.ajax.request(this,this.wizardResponse,e.param(a))};b.calendar.prototype.wizardResponse=function(a){this.$root.replaceWith(a);
this.unload()};b.calendar.prototype.availabilityChanged=function(){var a=[],c=parseInt(this.$availabilityListbox.val(),10);a.push({name:"projectId",value:this.projectId});a.push({name:"availabilityId",value:c});a.push({name:"action",value:this.actionWizard});this.ajax.request(this,this.wizardResponse,e.param(a))};b.calendar.prototype.createCalendars=function(){var a=new Date,c=this.appointment===1,d=c?null:a;this.startDateBeforeShowDayDelegate=b.createDelegate(this,this.startDateBeforeShowDay);this.onChangeMonthYearStartDateDelegate=
c?null:b.createDelegate(this,this.onChangeMonthYearStartDate);this.onStartDateSelectDelegate=b.createDelegate(this,this.onStartDateSelect);this.onStartDateCloseDelegate=b.createDelegate(this,this.onStartDateClose);this.$startDate.datepicker({dateFormat:this.dateFormat,defaultDate:a,minDate:d,beforeShowDay:this.startDateBeforeShowDayDelegate,onChangeMonthYear:this.onChangeMonthYearStartDateDelegate,onSelect:this.onStartDateSelectDelegate,onClose:this.onStartDateCloseDelegate,showButtonPanel:true,closeText:"Clear"});
this.$datepickerElement=e("#ui-datepicker-div");if(this.availabilityId){if(this.$startDate.length>0){this.$startDate.attr("disabled",true);this.$startDate.val(this.$startDate.attr("data-calendarista-loading"))}this.calendarRequestByMonth(a.getFullYear(),a.getMonth()+1,null)}};b.calendar.prototype.getCalendarModelByMonth=function(a,c){return[{name:"projectId",value:this.projectId},{name:"availabilityId",value:this.availabilityId},{name:"appointment",value:this.appointment},{name:"changeMonthYear",
value:a+"-"+this.pad(c)+"-01"},{name:"clientTime",value:this.toTime(new Date)},{name:"timezone",value:this.timezone},{name:"action",value:this.actionMonthChange}]};b.calendar.prototype.calendarRequestByMonth=function(a,c){var d=this.getCalendarModelByMonth(a,c);this.ajax.request(this,this.calendarResponseByMonth,e.param(d))};b.calendar.prototype.calendarResponseByMonth=function(a){this.monthYearResponse(a);this.$startDate.datepicker("refresh");if(!this.calendarInitialized){this.calendarInitialized=
true;if(this.$startDate.length>0){this.$startDate.removeAttr("disabled");this.$startDate.val("");if(this.$startDateField.val()){this.startDateSelected=this.$startDateField.val();this.$startDate.datepicker("setDate",this.parseDate(this.startDateSelected));this.onStartDateSelect(this.startDateSelected)}}}};b.calendar.prototype.createUniqueCalendar=function(){var a="calendarista-calendar-"+this.projectId;this.$calendarLegend.removeClass("hide");this.$calendarLegend.appendTo(this.$datepickerElement);
if(!this.$datepickerElement.hasClass(a)){this.$datepickerElement.removeClass(this.$datepickerElement.attr("data-calendarista-classname")+" calendarista-flat calendarista-borderless");this.$datepickerElement.removeAttr("data-calendarista-classname");this.$datepickerElement.attr("data-calendarista-classname",a);this.$datepickerElement.addClass(a+" calendarista-flat calendarista-borderless");this.$datepickerElement.addClass("calendarista-datepicker")}};b.calendar.prototype.resetUniqueCalendar=function(){this.$datepickerElement.removeClass("calendarista-calendar-"+
this.projectId+" calendarista-flat calendarista-borderless");this.$datepickerElement.removeAttr("data-calendarista-classname");this.$calendarLegend.addClass("hide");this.$calendarLegend.appendTo(this.$root)};b.calendar.prototype.onStartDateClose=function(a,c){var d=arguments.callee.caller.caller.caller.arguments[0];a&&this.$startDate.parsley().reset();this.resetUniqueCalendar();if(d&&e(d.delegateTarget).hasClass("ui-datepicker-close"))this.datepickerReset();else if(this.startDateSelected!==a){this.startDateSelected=
a;if(!a){d=this.startDateSelected?this.parseDate(this.startDateSelected):new Date;this.onChangeMonthYearStartDate(d.getFullYear(),d.getMonth()+1,c)}}};b.calendar.prototype.datepickerReset=function(){this.$startDate.datepicker("setDate",null);this.$startDate.datepicker("option","maxDate",null);this.$startTimeslotPlaceHolder&&this.$startTimeslotPlaceHolder.empty();this.$startDateField.val("");this.startDateSelected=null;this.$costSummaryPlaceholder.html("")};b.calendar.prototype.beforeShowDay=function(a,
c){a.getDay();var d=this.toYMD(a),f=new Date,h=true,g="";this.startDateSelected&&this.parseDate(this.startDateSelected);f.setHours(0,0,0,0);this.createUniqueCalendar();if(this.currentMonthExclusions.indexOf(d)!==-1){h=false;g="calendarista-unavailable"}if(d===c)g+=" calendarista-selectedday";else if(a.getTime()==f.getTime())g+=" calendarista-current";if(!h||a<f)g="calendarista-unavailable";else g||(g="calendarista-available");return[h,g]};b.calendar.prototype.startDateBeforeShowDay=function(a){var c=
this.startDateSelected?this.toYMD(this.parseDate(this.startDateSelected)):null;return this.beforeShowDay(a,c,0)};b.calendar.prototype.onChangeMonthYearStartDate=function(a,c){if(this.appointment!==1){var d=this.getCalendarModelByMonth(a,c);this.calendarStateToggle();this.ajax.request(this,this.monthYearStartDateResponse,e.param(d))}};b.calendar.prototype.monthYearStartDateResponse=function(a){this.monthYearResponse(a);this.$startDate.datepicker("refresh")};b.calendar.prototype.calendarStateToggle=
function(){var a=this;window.setTimeout(function(){a.addSpinner();e(".ui-datepicker-calendar a").parent().addClass("ui-datepicker-unselectable ui-state-disabled calendarista-unavailable")},10)};b.calendar.prototype.addSpinner=function(){var a=e(".calendarista-spinner img"),c=e(".calendarista-calendar-spinner");if(a.length>0&&c.length===0){c=a.clone();c.addClass("calendarista-calendar-spinner");e(".ui-datepicker-title").append(c)}};b.calendar.prototype.monthYearResponse=function(a){a=window.JSON.parse(a);
this.currentMonthExclusions.length=0;if(a.exclusions)this.currentMonthExclusions=a.exclusions};b.calendar.prototype.onStartDateSelect=function(a){var c=this.toTime(new Date);a=this.toYMD(this.parseDate(a));var d=[{name:"projectId",value:this.projectId},{name:"availabilityId",value:this.availabilityId},{name:"selectedDate",value:a},{name:"clientTime",value:c},{name:"timezone",value:this.timezone},{name:"__viewstate",value:this.$viewState.val()},{name:"appointment",value:this.appointment},{name:"action",
value:this.actionStartDaySelected}];this.$viewState.val();this.currentTime=c;this.$startDateField.val(a);this.timeslotCalendarModes.indexOf(this.calendarMode)!==-1&&this.ajax.request(this,this.startDayResponse,e.param(d));[0].indexOf(this.calendarMode)!==-1&&this.costSummaryRequest()};b.calendar.prototype.startDayResponse=function(a){this.$startTimeListbox&&this.$startTimeListbox.off();this.$startTimeReset&&this.$startTimeReset.off();this.$startTimeslotPlaceHolder.removeClass("hide");this.$startTimeslotPlaceHolder.replaceWith(a);
this.$startTimeslotPlaceHolder=this.$root.find(".calendarista-start-timeslot-placeholder");this.$startTimeListbox=this.$root.find('select[name="startTime"]');if(this.$startTimeListbox.length===0)this.$startTimeListbox=this.$root.find('select[name="startTime[]"]');this.$startTimeReset=this.$root.find(".calendarista-starttime-reset");this.$startTimeListbox.on("change",b.createDelegate(this,this.onStartTimeSelected));this.$startTimeReset.on("click",b.createDelegate(this,this.timeResetClick));if(!this.validateTimeslots(this.$startTimeListbox)){this.$startDate.datepicker("setDate",
null);this.$startDateField.val("")}if([0].indexOf(this.calendarMode)!==-1)this.costSummaryRequest();else[1].indexOf(this.calendarMode)!==-1&&this.$startTimeListbox.length>0&&this.$startTimeListbox[0].selectedIndex>0&&this.costSummaryRequest()};b.calendar.prototype.getCostSummaryModel=function(){var a=this.$startTimeListbox?this.$startTimeListbox.val():"",c=this.$startDateField?this.$startDateField.val():"";switch(this.calendarMode){case 1:if(!a){this.costSummaryReset();return false}}if(a instanceof
Array)a=a[0];return[{name:"projectId",value:this.projectId},{name:"availabilityId",value:this.availabilityId},{name:"appointment",value:this.appointment},{name:"availableDate",value:c},{name:"startTime",value:a},{name:"endDate",value:null},{name:"endTime",value:null},{name:"seats",value:null},{name:"calendarMode",value:this.calendarMode},{name:"postbackStep",value:this.$postbackStep.val()},{name:"__viewstate",value:this.$viewState.val()},{name:"action",value:this.actionCostSummary}]};b.calendar.prototype.costSummaryRequest=
function(){if(this.$root.find('input[name="costAppliesByDistance"]').length)return false;var a=this.getCostSummaryModel();if(!a)return false;(function(c,d){window.setTimeout(function(){d.ajax.request(d,d.costSummaryResponse,e.param(c))},10)})(a,this)};b.calendar.prototype.costSummaryResponse=function(a){this.$costSummaryPlaceholder.html(a)};b.calendar.prototype.costSummaryReset=function(){this.$costSummaryPlaceholder.html("")};b.calendar.prototype.validateTimeslots=function(a){var c=a.find("option:not([disabled])");
if(a.length===0){this.$timeslotsError.removeClass("hide");return false}if(a.attr("type")==="hidden"||c.length===1){this.$timeslotsError.removeClass("hide");return false}this.$timeslotsError.addClass("hide");return true};b.calendar.prototype.onStartTimeSelected=function(){this.costSummaryRequest()};b.calendar.prototype.timeResetClick=function(a){a.preventDefault();this.timeReset()};b.calendar.prototype.timeReset=function(){var a=this.$startTimeListbox?this.$startTimeListbox.find("option"):null;if(a){a.removeAttr("disabled");
if(this.$startTimeListbox.length>0)this.$startTimeListbox[0].selectedIndex=0;this.resetTimeslot(a);this.$startTimeReset.addClass("calendarista-not-active");this.$startTimeReset.attr("disabled",true)}};b.calendar.prototype.resetTimeslot=function(a){if(a){var c,d;for(c=1;c<a.length;c++){d=e(a[c]);d.html(d.attr("data-calendarista-time"))}}};b.calendar.prototype.disableTimeResetButtons=function(a){if(a.find("option[disabled]").length>0){if(this.$startTimeReset){this.$startTimeReset.removeClass("calendarista-not-active");
this.$startTimeReset.removeAttr("disabled")}}else if(this.$startTimeReset){this.$startTimeReset.addClass("calendarista-not-active");this.$startTimeReset.attr("disabled",true)}};b.calendar.prototype.toYMD=function(a){var c=a.getFullYear().toString(),d=(a.getMonth()+1).toString();a=a.getDate().toString();return c+"-"+this.pad(d)+"-"+this.pad(a)};b.calendar.prototype.toTime=function(a){var c=a.getHours();a=this.pad(a.getMinutes());var d=c>=12?"pm":"am";c%=12;c=c?c:12;return c+":"+a+" "+d};b.calendar.prototype.parseDate=
function(a){return e.datepicker.parseDate(this.dateFormat,a)};b.calendar.prototype.pad=function(a){return("0"+a).slice(-2)};b.calendar.prototype.unload=function(){this.$startTimeListbox&&this.$startTimeListbox.off();this.$startTimeReset&&this.$startTimeReset.off();this.$startDate.data("datepicker")!=null&&this.$startDate.datepicker("destroy");this.$projectsListbox.length&&this.$projectsListbox.off();this.$availabilityListbox.length&&this.$availabilityListbox.off();this.ajax&&this.ajax.destroy();if(this.unloadDelegate){e(window).off("unload",
this.unloadDelegate);delete this.unloadDelegate}}})(window.jQuery,window.Calendarista,window.jstz);
(function(e,b){b.checkout=function(a){this.init(a);this.unloadDelegate=b.createDelegate(this,this.unload);e(window).unload(this.unloadDelegate)};b.checkout.prototype.init=function(a){this.id=a.id;this.projectId=a.projectId;this.ajaxUrl=a.ajaxUrl;this.$root=e("#"+this.id);this.actionCostSummary="calendarista_cost_summary";this.actionValidateCoupon="calendarista_coupon_validator";this.ajax=new b.ajax({ajaxUrl:this.ajaxUrl,id:this.id});this.$costSummaryPlaceholder=this.$root.find(".calendarista-cost-summary-placeholder");
this.$viewstate=this.$root.find('input[name="__viewstate"]');this.$paymentType=this.$root.find('input[name="paymentType"]');this.creditCardSection=this.$root.find("#collapse_creditcard_"+this.projectId);this.$coupon=this.$root.find('input[name="coupon"]');this.couponMinimumAmountError=this.$coupon.attr("data-calendarista-coupon-minimum-amount-error");this.couponInvalidError=this.$coupon.attr("data-calendarista-coupon-invalid-error");this.$couponButton=this.$root.find('input[name="couponButton"]');
this.$couponResetButton=this.$root.find('input[name="couponResetButton"]');this.$coupon.length>0&&this.$coupon.parsley().on("field:success",b.createDelegate(this,this.removeCouponError));this.$couponButton.on("click",b.createDelegate(this,this.couponButtonClicked));this.$couponResetButton.on("click",b.createDelegate(this,this.resetCouponClicked));this.$paymentType.on("change",b.createDelegate(this,this.paymentTypeChanged))};b.checkout.prototype.resetCouponClicked=function(){var a;this.$coupon.val()&&
this.$coupon.val("");this.costSummaryRequest();this.removeCouponError();a=this.$root.find('input[name="paymentMethod"]');if(a.is(":disabled")){a.removeAttr("disabled");e(a[0]).attr("checked",true)}};b.checkout.prototype.removeCouponError=function(){this.$coupon.parsley().removeError("couponerror",{updateClass:true})};b.checkout.prototype.couponButtonClicked=function(){this.$coupon.val();var a;this.removeCouponError();a=this.$coupon.parsley?this.$coupon.parsley().validate():true;a!==null&&typeof a===
"object"&&a.length>0?this.costSummaryRequest():this.couponValidator()};b.checkout.prototype.couponValidator=function(){var a=[{name:"projectId",value:this.projectId},{name:"coupon",value:this.$coupon.val()},{name:"action",value:this.actionValidateCoupon}];this.ajax.request(this,this.validationResponse,e.param(a))};b.checkout.prototype.validationResponse=function(a){a=window.JSON.parse(a);if(!a.isValid&&a.orderMinimum)this.$coupon.parsley().addError("couponerror",{message:this.couponMinimumAmountError.replace("%s",
a.orderMinimum),updateClass:true});else a.isValid||this.$coupon.parsley().addError("couponerror",{message:this.couponInvalidError,updateClass:true});if(a.isValid&&a.fullDiscount){a=this.$root.find('input[name="paymentMethod"]');a.removeAttr("checked");a.attr("disabled",true)}this.costSummaryRequest()};b.checkout.prototype.costSummaryRequest=function(){var a=[{name:"coupon",value:this.$coupon.val()},{name:"__viewstate",value:this.$viewstate.val()},{name:"action",value:this.actionCostSummary}];this.ajax.request(this,
this.costSummaryResponse,e.param(a))};b.checkout.prototype.costSummaryResponse=function(a){this.$costSummaryPlaceholder.html(a)};b.checkout.prototype.costSummaryReset=function(){this.$costSummaryPlaceholder.html("")};b.checkout.prototype.paymentTypeChanged=function(a){parseInt(e(a.target).val(),10)!==1&&this.creditCardSection.collapse("hide")};b.checkout.prototype.unload=function(){if(this.unloadDelegate){e(window).off("unload",this.unloadDelegate);delete this.unloadDelegate}this.$couponButton.off();
this.$paymentType.off()}})(window.jQuery,window.Calendarista);
(function(e,b){b.customForm=function(a){this.init(a);this.unloadDelegate=b.createDelegate(this,this.unload);e(window).unload(this.unloadDelegate)};b.customForm.prototype.init=function(a){this.id=a.id;this.projectId=a.projectId;this.actionCreateUser="calendarista_create_user";this.actionSignOn="calendarista_signon";this.actionCustomTypeChanged="calendarista_customer_type_changed";this.ajaxUrl=a.ajaxUrl;this.membershipRequired=a.membershipRequired;this.$root=e("#"+this.id);this.ajax=new b.ajax({ajaxUrl:this.ajaxUrl,
id:this.id});this.$customerTypeContainer=this.$root.find(".customer-type-container");this.$customerType=this.$root.find('input[name="customerType"]');this.$email=this.$root.find('input[name="email"]');this.$name=this.$root.find('input[name="name"]');this.$password=this.$root.find('input[name="password"]');this.$createUserValidator=this.$root.find('input[name="createUserValidator"]');this.$signOnValidator=this.$root.find('input[name="signOnValidator"]');this.$nextButton=this.$root.find('button[name="next"]');
this.$customerType.on("change",b.createDelegate(this,this.customerTypeChanged));this.nextButtonClickDelegate=b.createDelegate(this,this.nextButtonClicked);this.$nextButton.on("click",this.nextButtonClickDelegate);this.$container=this.$root.find(".calendarista-custom-form")};b.customForm.prototype.nextButtonClicked=function(){var a,c=parseInt(this.$customerType.filter(":checked").val(),10);if(b.wizard.isValid(this.$root)){if(this.membershipRequired){a=[{name:"projectId",value:this.projectId},{name:"name",
value:this.$name.val()},{name:"email",value:this.$email.val()},{name:"password",value:this.$password.val()}];if(c===0&&!this.$customerTypeContainer.hasClass("hide")){this.$createUserValidator.val("");a.push({name:"action",value:this.actionCreateUser});this.ajax.request(this,this.createUserResponse,e.param(a))}else if(c===1){this.$signOnValidator.val("");a.push({name:"action",value:this.actionSignOn});this.ajax.request(this,this.signOnResponse,e.param(a))}}this.unload()}};b.customForm.prototype.createUserResponse=
function(a){var c=this.$root.find(".create-user-error");if(a==="null"){b.wizard.isValid(this.$root);c.removeClass("hide")}this.$createUserValidator.val(1);if(a!=="null"){c.addClass("hide");this.$customerTypeContainer.addClass("hide");this.$nextButton.click()}};b.customForm.prototype.signOnResponse=function(a){var c=this.$root.find(".signon-error");if(a==="null"){b.wizard.isValid(this.$root);c.removeClass("hide")}this.$signOnValidator.val(1);if(a!=="null"){c.addClass("hide");this.$customerType.filter('[value="0"]').attr("checked",
true);this.customerTypeRequest();this.$customerTypeContainer.addClass("hide")}};b.customForm.prototype.customerTypeChanged=function(){this.customerTypeRequest()};b.customForm.prototype.customerTypeRequest=function(){var a=[{name:"customerType",value:parseInt(this.$customerType.filter(":checked").val(),10)},{name:"projectId",value:this.projectId},{name:"action",value:this.actionCustomTypeChanged}];this.ajax.request(this,this.customerTypeChangedResponse,e.param(a))};b.customForm.prototype.customerTypeChangedResponse=
function(a){this.$container.html(a);this.$email=this.$root.find('input[name="email"]');this.$name=this.$root.find('input[name="name"]');this.$password=this.$root.find('input[name="password"]')};b.customForm.prototype.unload=function(){if(this.unloadDelegate){e(window).off("unload",this.unloadDelegate);delete this.unloadDelegate}this.$customerType.off();this.$root.off("click",'button[name="next"]',this.nextButtonClickDelegate)}})(window.jQuery,window.Calendarista);
